<Window x:Class="WannaTool.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:WannaTool"
        mc:Ignorable="d"
        Title="WannaTool Settings"
        Height="600" Width="900"
        WindowStartupLocation="CenterScreen"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ResizeMode="NoResize"
        Icon="WannaToolIcon.ico">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis" />

        <SolidColorBrush x:Key="BgBrush" Color="#18181B"/>
        <SolidColorBrush x:Key="CardBgBrush" Color="#27272A"/>
        <SolidColorBrush x:Key="AccentBrush" Color="#6366F1"/>
        <SolidColorBrush x:Key="TextPrimaryBrush" Color="#F4F4F5"/>
        <SolidColorBrush x:Key="TextSecondaryBrush" Color="#A1A1AA"/>
        <SolidColorBrush x:Key="BorderBrush" Color="#3F3F46"/>

        <Style x:Key="ModernScrollBar" TargetType="{x:Type ScrollBar}">
            <Setter Property="Stylus.IsPressAndHoldEnabled" Value="false"/>
            <Setter Property="Stylus.IsFlicksEnabled" Value="false"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Width" Value="8"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ScrollBar}">
                        <Grid x:Name="Bg" SnapsToDevicePixels="true">
                            <Track x:Name="PART_Track" IsDirectionReversed="true">
                                <Track.Thumb>
                                    <Thumb Style="{DynamicResource ScrollThumbStyle}"/>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="ScrollThumbStyle" TargetType="{x:Type Thumb}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Thumb}">
                        <Border Background="#555555" CornerRadius="4" Margin="2,0"/>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="NavButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="16,10"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Margin" Value="0,2"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Bd" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}" CornerRadius="6">
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#1AFFFFFF"/>
                                <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                            </Trigger>
                            <Trigger Property="Tag" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#2A6366F1"/>
                                <Setter Property="Foreground" Value="{StaticResource AccentBrush}"/>
                                <Setter Property="FontWeight" Value="SemiBold"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="PrimaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource AccentBrush}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Bd" Background="{TemplateBinding Background}" CornerRadius="6" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Opacity" Value="0.9"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="Bd" Property="Opacity" Value="0.8"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="Bd" Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="GhostButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Bd" Background="{TemplateBinding Background}" CornerRadius="4" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#1AFFFFFF"/>
                                <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="IconButtonStyle" TargetType="Button" BasedOn="{StaticResource GhostButtonStyle}">
            <Setter Property="Padding" Value="6"/>
            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
        </Style>

        <Style x:Key="ModernToggleSwitch" TargetType="CheckBox">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <Grid Background="Transparent">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Border x:Name="SwitchTrack" Grid.Column="1" Width="40" Height="24" CornerRadius="12" Background="#333" BorderBrush="#555" BorderThickness="1">
                                <Ellipse x:Name="SwitchThumb" Width="18" Height="18" Fill="#AAA" HorizontalAlignment="Left" Margin="2,0"/>
                            </Border>
                            <ContentPresenter Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="SwitchTrack" Property="Background" Value="{StaticResource AccentBrush}"/>
                                <Setter TargetName="SwitchTrack" Property="BorderBrush" Value="{StaticResource AccentBrush}"/>
                                <Setter TargetName="SwitchThumb" Property="HorizontalAlignment" Value="Right"/>
                                <Setter TargetName="SwitchThumb" Property="Fill" Value="White"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="PageTitle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="28"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
            <Setter Property="Margin" Value="0,0,0,24"/>
        </Style>

        <Style x:Key="SectionHeader" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
            <Setter Property="Margin" Value="0,0,0,8"/>
        </Style>

        <Style x:Key="SubText" TargetType="TextBlock">
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
        </Style>

        <Style x:Key="InlineInput" TargetType="TextBox">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="Padding" Value="0,2"/>
            <Setter Property="CaretBrush" Value="{StaticResource AccentBrush}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border x:Name="Bd" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                            <ScrollViewer x:Name="PART_ContentHost"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="BorderBrush" Value="#33FFFFFF"/>
                            </Trigger>
                            <Trigger Property="IsKeyboardFocused" Value="True">
                                <Setter TargetName="Bd" Property="BorderBrush" Value="{StaticResource AccentBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="Card" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource CardBgBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="16"/>
            <Setter Property="Margin" Value="0,0,0,12"/>
        </Style>

    </Window.Resources>

    <Grid>
        <Border Background="{StaticResource BgBrush}" CornerRadius="12" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="240"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Border Grid.Column="0" Background="#0AFFFFFF" CornerRadius="12,0,0,12" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,1,0">
                    <Grid>
                        <StackPanel Margin="16,32,16,16">
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,32">
                                <Image Source="pack://application:,,,/WannaToolIcon.ico" Width="24" Height="24" Margin="0,0,12,0" RenderOptions.BitmapScalingMode="HighQuality"/>
                                <TextBlock Text="Settings" Foreground="{StaticResource TextPrimaryBrush}" FontSize="18" FontWeight="Bold" VerticalAlignment="Center"/>
                            </StackPanel>
                            
                            <Button Content="General" Command="{Binding NavCommand}" CommandParameter="General" Style="{StaticResource NavButtonStyle}" Tag="{Binding IsGeneralVisible}"/>
                            <Button Content="Search &amp; redirects" Command="{Binding NavCommand}" CommandParameter="Search" Style="{StaticResource NavButtonStyle}" Tag="{Binding IsSearchVisible}"/>
                            <Button Content="Maintenance" Command="{Binding NavCommand}" CommandParameter="Maintenance" Style="{StaticResource NavButtonStyle}" Tag="{Binding IsMaintenanceVisible}"/>
                            <Button Content="About" Command="{Binding NavCommand}" CommandParameter="About" Style="{StaticResource NavButtonStyle}" Tag="{Binding IsAboutVisible}"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <Grid Grid.Column="1">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <Grid Grid.Row="0" Margin="0,16,16,0">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button Content="Save changes" 
                                    Command="{Binding SaveCommand}" 
                                    Style="{StaticResource PrimaryButtonStyle}" 
                                    Margin="0,0,16,0"
                                    Visibility="{Binding IsDirty, Converter={StaticResource BoolToVis}}"/>
                            <Button Content="âœ•" Style="{StaticResource GhostButtonStyle}" Click="CloseButton_Click"/>
                        </StackPanel>
                    </Grid>

                    <Grid Grid.Row="1" Margin="40,10,40,40">
                        
                        <StackPanel Visibility="{Binding IsGeneralVisible, Converter={StaticResource BoolToVis}}">
                            <TextBlock Text="General" Style="{StaticResource PageTitle}"/>
                            
                            <Border Style="{StaticResource Card}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                        <TextBlock Text="Auto-start with Windows" Style="{StaticResource SectionHeader}"/>
                                        <TextBlock Text="Launch WannaTool automatically when you log in." Style="{StaticResource SubText}"/>
                                    </StackPanel>
                                    <CheckBox Grid.Column="1" IsChecked="{Binding AutoStart}" Style="{StaticResource ModernToggleSwitch}"/>
                                </Grid>
                            </Border>

                            <Border Style="{StaticResource Card}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <StackPanel Grid.Column="0" Grid.Row="0" VerticalAlignment="Center">
                                        <TextBlock Text="System monitoring" Style="{StaticResource SectionHeader}"/>
                                        <TextBlock Text="Show CPU &amp; RAM usage in the main window." Style="{StaticResource SubText}"/>
                                    </StackPanel>
                                    <CheckBox Grid.Column="1" Grid.Row="0" IsChecked="{Binding EnableSystemMonitoring}" Style="{StaticResource ModernToggleSwitch}"/>

                                    <StackPanel Grid.Column="0" Grid.ColumnSpan="2" Grid.Row="1" Margin="0,16,0,0" Orientation="Horizontal" 
                                                Visibility="{Binding EnableSystemMonitoring, Converter={StaticResource BoolToVis}}">
                                        <TextBlock Text="Update interval (s):" VerticalAlignment="Center" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,12,0"/>
                                        <TextBox Text="{Binding SystemMonitorInterval, Mode=TwoWay}" Style="{StaticResource InlineInput}" Width="40" TextAlignment="Center"/>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </StackPanel>

                        <Grid Visibility="{Binding IsSearchVisible, Converter={StaticResource BoolToVis}}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <TextBlock Text="Search &amp; redirects" Style="{StaticResource PageTitle}"/>

                            <Border Grid.Row="1" Background="{StaticResource CardBgBrush}" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" CornerRadius="8" Padding="4">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <ScrollViewer.Resources>
                                        <Style TargetType="{x:Type ScrollBar}" BasedOn="{StaticResource ModernScrollBar}"/>
                                    </ScrollViewer.Resources>
                                    <ItemsControl ItemsSource="{Binding Redirects}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border x:Name="RowBorder" Background="Transparent" Padding="12,10" CornerRadius="4" Margin="0,1">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="140"/>
                                                            <ColumnDefinition Width="100"/>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>

                                                        <TextBox Grid.Column="0" Text="{Binding Name, Mode=TwoWay}" Style="{StaticResource InlineInput}" FontWeight="SemiBold" VerticalAlignment="Center"/>

                                                        <Border Grid.Column="1" Background="#1A6366F1" CornerRadius="10" Padding="8,2" HorizontalAlignment="Left" VerticalAlignment="Center">
                                                            <TextBox Text="{Binding Trigger, Mode=TwoWay}" Style="{StaticResource InlineInput}" Foreground="{StaticResource AccentBrush}" FontWeight="Bold" FontSize="12" BorderThickness="0"/>
                                                        </Border>

                                                        <TextBox Grid.Column="2" Text="{Binding UrlTemplate, Mode=TwoWay}" Style="{StaticResource InlineInput}" Foreground="{StaticResource TextSecondaryBrush}" Margin="12,0" VerticalAlignment="Center"/>

                                                        <Button Grid.Column="3" Content="ðŸ—‘" 
                                                                Command="{Binding DataContext.RemoveRedirectCommand, RelativeSource={RelativeSource AncestorType=Window}}" 
                                                                CommandParameter="{Binding}"
                                                                Style="{StaticResource IconButtonStyle}"
                                                                Foreground="#EF4444"
                                                                Opacity="0" x:Name="DeleteBtn"/>
                                                    </Grid>
                                                    <Border.Triggers>
                                                        <EventTrigger RoutedEvent="MouseEnter">
                                                            <BeginStoryboard>
                                                                <Storyboard>
                                                                    <ColorAnimation Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)" To="#333" Duration="0:0:0.1"/>
                                                                    <DoubleAnimation Storyboard.TargetName="DeleteBtn" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.1"/>
                                                                </Storyboard>
                                                            </BeginStoryboard>
                                                        </EventTrigger>
                                                        <EventTrigger RoutedEvent="MouseLeave">
                                                            <BeginStoryboard>
                                                                <Storyboard>
                                                                    <ColorAnimation Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)" To="Transparent" Duration="0:0:0.1"/>
                                                                    <DoubleAnimation Storyboard.TargetName="DeleteBtn" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.1"/>
                                                                </Storyboard>
                                                            </BeginStoryboard>
                                                        </EventTrigger>
                                                    </Border.Triggers>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </ScrollViewer>
                            </Border>

                            <Button Grid.Row="2" Content="+ Add redirect" 
                                    Command="{Binding AddRedirectCommand}"
                                    Style="{StaticResource PrimaryButtonStyle}"
                                    HorizontalAlignment="Left" Margin="0,16,0,0"/>
                        </Grid>

                        <StackPanel Visibility="{Binding IsMaintenanceVisible, Converter={StaticResource BoolToVis}}">
                            <TextBlock Text="Maintenance" Style="{StaticResource PageTitle}"/>

                            <Border Style="{StaticResource Card}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                        <TextBlock Text="Rebuild search index" Style="{StaticResource SectionHeader}"/>
                                        <TextBlock Text="Force a full rescan if search results are missing or outdated." Style="{StaticResource SubText}"/>
                                    </StackPanel>
                                    <Button Grid.Column="1" Content="Rebuild index" Command="{Binding ReindexCommand}" Style="{StaticResource GhostButtonStyle}" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1"/>
                                </Grid>
                            </Border>
                        </StackPanel>

                        <StackPanel Visibility="{Binding IsAboutVisible, Converter={StaticResource BoolToVis}}">
                            <TextBlock Text="About" Style="{StaticResource PageTitle}"/>

                            <StackPanel HorizontalAlignment="Center" Margin="0,60,0,0">
                                <TextBlock Text="{Binding AppName}" FontSize="40" FontWeight="ExtraBold" Foreground="{StaticResource TextPrimaryBrush}" HorizontalAlignment="Center"/>
                                <Border Background="#1AFFFFFF" CornerRadius="12" Padding="12,4" Margin="0,8,0,32" HorizontalAlignment="Center">
                                    <TextBlock Text="{Binding AppVersion}" FontSize="14" Foreground="{StaticResource TextSecondaryBrush}"/>
                                </Border>
                                
                                <TextBlock Text="Created by" Foreground="{StaticResource TextSecondaryBrush}" HorizontalAlignment="Center"/>
                                <TextBlock Text="{Binding Author}" Foreground="{StaticResource TextPrimaryBrush}" FontWeight="SemiBold" FontSize="16" HorizontalAlignment="Center" Margin="0,4,0,32"/>

                                <Button Content="Open help documentation" Command="{Binding OpenHelpCommand}" 
                                        Style="{StaticResource PrimaryButtonStyle}" 
                                        HorizontalAlignment="Center"
                                        Margin="0,0,0,16"
                                        Cursor="Hand"/>

                                <Button Content="View source on GitHub" Command="{Binding OpenRepoCommand}" 
                                        Style="{StaticResource GhostButtonStyle}" 
                                        Foreground="{StaticResource AccentBrush}" 
                                        Cursor="Hand"/>
                            </StackPanel>
                        </StackPanel>

                    </Grid>
                </Grid>
            </Grid>
        </Border>
    </Grid>
</Window>
