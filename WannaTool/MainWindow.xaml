<Window x:Class="WannaTool.MainWindow"
       xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
       xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
       Title="WannaTool"
       WindowStartupLocation="CenterScreen"
       WindowStyle="None"
       AllowsTransparency="True"
       Background="Transparent"
       ShowInTaskbar="False"
       Topmost="True"
       Width="800" Height="300">

   <Grid Background="Transparent">
       <!-- Fond semi-transparent -->
       <Grid Background="#80000000">

           <!-- Barre de recherche -->
           <Border 
               Background="#CC333333" 
               CornerRadius="15" 
               HorizontalAlignment="Center" 
               VerticalAlignment="Top"
               Width="600" Height="50"
               Margin="0,30,0,0"
               Padding="10">

               <Border.Effect>
                   <DropShadowEffect 
                       Color="Black" 
                       BlurRadius="20" 
                       Opacity="0.5" 
                       ShadowDepth="5" />
               </Border.Effect>

                <TextBox Name="SearchBox"
                        FontSize="18"
                        Background="Transparent"
                        BorderThickness="0"
                        Foreground="White"
                        VerticalContentAlignment="Center"
                        HorizontalContentAlignment="Left"
                        Margin="5,0"
                        TextChanged="SearchBox_TextChanged"
                        KeyDown="SearchBox_KeyDown">
                    <TextBox.Style>
                       <Style TargetType="TextBox">
                           <Setter Property="Template">
                               <Setter.Value>
                                   <ControlTemplate TargetType="TextBox">
                                       <Grid>
                                           <TextBox Text="{Binding Text, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    Background="Transparent"
                                                    BorderThickness="0"
                                                    Foreground="White"
                                                    CaretBrush="White"
                                                    VerticalContentAlignment="Center"
                                                    HorizontalContentAlignment="Left" />
                                           <TextBlock Text="Rechercher..."
                                                      Foreground="Gray"
                                                      VerticalAlignment="Center"
                                                      HorizontalAlignment="Left"
                                                      Margin="5,0"
                                                      IsHitTestVisible="False"
                                                      Visibility="{Binding Text, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource StringNotNullOrEmptyToVisibilityConverter}}" />
                                       </Grid>
                                   </ControlTemplate>
                               </Setter.Value>
                           </Setter>
                       </Style>
                   </TextBox.Style>
                </TextBox>

           </Border>

           <!-- Liste des résultats -->
           <ListBox x:Name="ResultsList"
                    Width="600"
                    Margin="100,100,100,20"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Top"
                    Background="#CC333333"
                    Foreground="White"
                    BorderBrush="White"
                    BorderThickness="0"
                    Visibility="Collapsed"
                    FontSize="16"
                    ScrollViewer.VerticalScrollBarVisibility="Hidden"
                    ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                    KeyDown="ResultsList_KeyDown">
               <ListBox.Resources>
                   <Style TargetType="{x:Type ScrollBar}">
                       <Setter Property="Width" Value="8"/>
                       <Setter Property="Background" Value="Transparent"/>
                       <Setter Property="Foreground" Value="#66FFFFFF"/>
                   </Style>
                   <DataTemplate x:Key="ResultTemplate">
                       <Border>
                           <StackPanel Orientation="Horizontal" Margin="5">
                               <Image Source="{Binding Icon}" Width="24" Height="24" Margin="0,0,10,0" VerticalAlignment="Center"/>
                               <StackPanel Orientation="Vertical" Margin="5">
                                   <TextBlock Text="{Binding DisplayName}" 
                              FontSize="16" 
                              Foreground="White"
                              VerticalAlignment="Center"
                              TextTrimming="CharacterEllipsis"/>
                                   <TextBlock Text="{Binding FullPath}" 
                              FontSize="12" 
                              Foreground="Gray" 
                              TextTrimming="CharacterEllipsis"
                              TextWrapping="NoWrap"
                              MaxWidth="500"
                              Margin="0,2,0,0"/>
                               </StackPanel>
                           </StackPanel>
                           <Border.ContextMenu>
                               <ContextMenu>
                                   <MenuItem Header="Ouvrir" Click="OpenFile_Click"/>
                                   <MenuItem Header="Ouvrir l'emplacement" Click="OpenLocation_Click"/>
                                   <MenuItem Header="Copier le chemin" Click="CopyPath_Click"/>
                                   <Separator />
                                   <MenuItem Header="Supprimer" Click="DeleteFile_Click"/>
                                   <MenuItem Header="Renommer" Click="RenameFile_Click"/>
                                   <Separator />
                                   <MenuItem Header="Propriétés" Click="ShowProperties_Click"/>
                               </ContextMenu>
                           </Border.ContextMenu>
                       </Border>
                   </DataTemplate>
               </ListBox.Resources>
               <ListBox.ItemTemplate>
                   <StaticResource ResourceKey="ResultTemplate"/>
               </ListBox.ItemTemplate>
           </ListBox>
       </Grid>
        <TextBlock x:Name="LoadingIndicator"
          Text="Indexation en cours..."
          Foreground="White"
          FontSize="16"
          HorizontalAlignment="Center"
          VerticalAlignment="Top"
          Margin="0,20,0,0"
          Visibility="Collapsed"
          />
    </Grid>
</Window>